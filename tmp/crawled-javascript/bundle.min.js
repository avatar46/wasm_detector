!function(){"use strict";
/**
     Carbonium 1.2.0
     @copyright 2020 Edwin Martin
     @license MIT
     */function t(t,e){let s;return s="<"==t[0]?[(new DOMParser).parseFromString(t,"text/html").body.firstChild]:(e||document).querySelectorAll(t),new Proxy(s,n)}let e,s;const n={get(t,i){let o=null;if(i==Symbol.iterator)return function*(){for(let e=0;e<t.length;e++)yield t[e]};if("style"==i||"classList"==i||"relList"==i){e=t,s=i;const o=Reflect.get(document.body,i);return new Proxy(o,n)}if(t instanceof CSSStyleDeclaration||t instanceof DOMTokenList)return o=Reflect.get(document.body[s],i),"function"==typeof o?new Proxy(o,{apply:function(t,i,o){return e.forEach((e=>{Reflect.apply(t,e[s],o)})),new Proxy(e,n)}}):o;if(Array.prototype.hasOwnProperty(i)){const t=Reflect.get(Array.prototype,i);if("function"==typeof t)return new Proxy(t,{apply:function(t,e,s){const i=Reflect.apply(t,e,s);return new Proxy(void 0!==i?i:e,n)}})}return t.length>0?i in t[0]&&(o=Reflect.get(t[0],i)):i in document.body&&(o=Reflect.get(document.body,i)),o?"function"==typeof o?new Proxy(o,{apply:function(t,e,s){let n=null,i=!0;for(const o of e){const e=Reflect.apply(t,o,s);i&&(n=e,i=!1)}return null!=n&&null!=n?n:e}}):o:Reflect.get(t,i)},set:(t,e,s)=>(!("forEach"in t)||t instanceof CSSStyleDeclaration?Reflect.set(t,e,s):t.forEach((t=>{Reflect.set(t,e,s)})),!0),deleteProperty:(t,e)=>e in t&&delete t[e]};
/**
     cuprum 0.1.16
     @copyright 2020 Edwin Martin <edwin@bitstorm.org>
     @license MIT
     */class i{constructor(){this.subscribers=new Set,this.subscribersHot=new Set,this.dispatched=!1,this.hot=!1,this.isSubject=!1}dispatch(t){if(this.isSubject)throw new Error("Can't dispatch on subject");return this.internalDispatch(t),this}subscribe(t){return this.dispatched&&t(this.val),this.subscribeNext(t)}unsubscribe(t){this.subscribers.delete(t),this.notifyHotSubscribers()}subscribeHot(t){return this.subscribersHot.add(t),{unsubscribe:()=>{this.subscribersHot.delete(t)}}}clear(){this.subscribers.clear(),this.subscribersHot.clear()}value(){return this.val}observable(){const t=this.map((t=>t));return t.isSubject=!0,t}promise(){return new Promise((t=>{const e=this.subscribe((function(s){e.unsubscribe(),t(s)}))}))}map(t){const e=new i,s=s=>{e.internalDispatch(t(s))};return e.subscribeHot((t=>{t?this.subscribe(s):this.unsubscribe(s)})),e}filter(t){const e=new i,s=s=>{t(s)&&e.dispatch(s)};return e.subscribeHot((t=>{t?this.subscribe(s):this.unsubscribe(s)})),e}notifyHotSubscribers(){this.subscribers.size>0!=this.hot&&(this.hot=this.subscribers.size>0,this.subscribersHot.forEach((t=>t(this.hot))))}subscribeNext(t){return this.subscribers.add(t),this.notifyHotSubscribers(),{unsubscribe:()=>{this.subscribers.delete(t)}}}internalDispatch(t){const e=this.val;this.val=t,this.dispatched=!0,this.subscribers.forEach((s=>s(t,e)))}}function o(t,e,s){return r(t,e,s)}function r(t,e,s){const n=new i,o=t=>{n.dispatch(t)};return n.subscribeHot((n=>{n?t.addEventListener(e,o,s):t.removeEventListener(e,o,s)})),n}function a(...t){const e=new i,s=new Set;return e.subscribeHot((n=>{n?t.forEach((n=>{s.add(n.subscribe((()=>{e.dispatch(t.map((t=>t.value())))})))})):s.forEach((t=>t.unsubscribe()))})),e}function c(...t){const e=new i,s=new Set;return e.subscribeHot((n=>{n?t.forEach((t=>{s.add(t.subscribe((t=>{e.dispatch(t)})))})):s.forEach((t=>t.unsubscribe()))})),e}function h(t,e,s,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(o<3?i(r):o>3?i(e,s,r):i(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r}function l(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function u(t,e,s,n){return new(s||(s=Promise))((function(i,o){function r(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}c((n=n.apply(t,e||[])).next())}))}
/*
     web-component-decorator 1.1.0
     @copyright 2020 Edwin Martin
     @license MIT
     */const d=Symbol();function b(t,e){return s=>{customElements.define(t,s,e)}}function p(t){return function(e,s,n){const i=n.value?"value":"set";return e.constructor[d]?(e.constructor.observedAttributes.push(t),e.constructor[d].set(t,n[i])):(e.constructor.observedAttributes=[t],e.constructor[d]=new Map([[t,n[i]]])),e.attributeChangedCallback=function(t,s,n){e.constructor[d].get(t).call(this,n,s)},n}}let g=class extends HTMLElement{constructor(){super(),this.dimension$=new i,this.offset$=new i,this.click$=new i,this.drag$=new i,this.initialPattern$=new i,this.dragStart={x:0,y:0},this.lastSize=-1,this.isDragging=!1,this.isMouseDown=!1,this.lastTouchCount=0,this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n      <style>\n        #canvas{\n          position: absolute;\n          left: var(--width-mod, 0);\n          cursor: var(--cursor, auto);\n        }\n      </style>\n      \n      <canvas id="canvas"></canvas>\n    '}connectedCallback(){this.canvasDomElement=t("#canvas",this.shadowRoot);try{let t=this.canvasDomElement.getBoundingClientRect();this.offscreen=new OffscreenCanvas(t.width,t.height),this.ctx=this.offscreen.getContext("2d",{alpha:!1}),this.ctxOffscreen=this.canvasDomElement.getContext("bitmaprenderer")}catch(t){this.ctx=this.canvasDomElement.getContext("2d",{alpha:!1})}this.setDragging();const e=this.dimension$.subscribe((()=>{this.initialPattern$.dispatch(this.textContent),e.unsubscribe()}))}getObservers(){return{click$:this.click$.observable(),dimension$:this.dimension$.observable(),offset$:this.offset$.observable(),initialPattern$:this.initialPattern$.observable()}}setDragging(){o(this.canvasDomElement,"mousedown").subscribe((t=>{this.dragStart={x:t.x,y:t.y},this.isMouseDown=!0})),o(this.canvasDomElement,"mouseup").subscribe((t=>{if(this.isMouseDown=!1,this.drag$.dispatch({x:0,y:0}),this.offset$.dispatch({x:Math.round((t.x-this.dragStart.x)/this.cellSize),y:Math.round((t.y-this.dragStart.y)/this.cellSize)}),!this.isDragging){const e=this.canvasDomElement.getBoundingClientRect();this.click$.dispatch({x:Math.floor((t.x-e.left-2)/this.cellSize),y:Math.floor((t.y-e.top-3)/this.cellSize)})}this.isDragging=!1})),o(this.canvasDomElement,"mousemove").subscribe((t=>{if(this.isMouseDown){const e=t.x-this.dragStart.x,s=t.y-this.dragStart.y;this.isDragging=Math.abs(e)>5||Math.abs(s)>5,this.isDragging&&this.drag$.dispatch({x:e,y:s})}})),o(this.canvasDomElement,"touchstart").subscribe((t=>{this.lastTouch={x:t.touches[0].clientX,y:t.touches[0].clientY},2==t.touches.length?(0==this.lastTouchCount&&(this.dragStart=Object.assign({},this.lastTouch)),this.dragStart.x+=(t.touches[0].clientX+t.touches[1].clientX)/2-t.touches[0].clientX,this.dragStart.y+=(t.touches[0].clientY+t.touches[1].clientY)/2-t.touches[0].clientY,this.distStart=Math.sqrt((t.touches[1].clientX-t.touches[0].clientX)*(t.touches[1].clientX-t.touches[0].clientX)+(t.touches[1].clientY-t.touches[0].clientY)*(t.touches[1].clientY-t.touches[0].clientY)),-1==this.lastSize&&(this.lastSize=this.distStart),this.sizeStart=this.cellSize/this.distStart,this.lastTouch={x:(t.touches[0].clientX+t.touches[1].clientX)/2,y:(t.touches[0].clientY+t.touches[1].clientY)/2}):this.dragStart=Object.assign({},this.lastTouch),this.lastTouchCount=t.touches.length})),o(this.canvasDomElement,"touchmove").subscribe((t=>{if(1==t.touches.length)this.lastTouch={x:t.touches[0].clientX,y:t.touches[0].clientY},this.drag$.dispatch({x:this.lastTouch.x-this.dragStart.x,y:this.lastTouch.y-this.dragStart.y});else if(2==t.touches.length){this.lastTouch={x:(t.touches[0].clientX+t.touches[1].clientX)/2,y:(t.touches[0].clientY+t.touches[1].clientY)/2},this.lastSize=Math.sqrt((t.touches[1].clientX-t.touches[0].clientX)*(t.touches[1].clientX-t.touches[0].clientX)+(t.touches[1].clientY-t.touches[0].clientY)*(t.touches[1].clientY-t.touches[0].clientY));let e=this.lastSize*this.sizeStart;e<2&&(e=2,this.lastSize=e/this.sizeStart),e>40&&(e=40,this.lastSize=e/this.sizeStart),this.setCellSize(e,!1),this.drag$.dispatch({x:this.lastTouch.x-this.dragStart.x*this.lastSize/this.distStart,y:this.lastTouch.y-this.dragStart.y*this.lastSize/this.distStart})}t.preventDefault()})),o(this.canvasDomElement,"touchend").subscribe((t=>{1==t.touches.length?(this.dragStart.x=this.dragStart.x*this.lastSize/this.distStart-this.lastTouch.x+t.touches[0].clientX,this.dragStart.y=this.dragStart.y*this.lastSize/this.distStart-this.lastTouch.y+t.touches[0].clientY,this.lastTouch={x:t.touches[0].clientX,y:t.touches[0].clientY}):0==t.touches.length&&(this.drag$.dispatch({x:0,y:0}),1==this.lastTouchCount?(this.offset$.dispatch({x:Math.round((this.lastTouch.x-this.dragStart.x)/this.cellSize),y:Math.round((this.lastTouch.y-this.dragStart.y)/this.cellSize)}),this.lastSize=-1):2==this.lastTouchCount&&this.offset$.dispatch({x:Math.round((this.lastTouch.x-this.dragStart.x*this.lastSize/this.distStart)/this.cellSize),y:Math.round((this.lastTouch.y-this.dragStart.y*this.lastSize/this.distStart)/this.cellSize)}),this.calculateDimensions()),this.lastTouchCount=t.touches.length})),o(this.canvasDomElement,"touchcancel").subscribe((()=>{this.drag$.dispatch({x:0,y:0}),this.offset$.dispatch({x:0,y:0}),this.lastTouchCount=0})),this.drag$.subscribe((({x:t,y:e})=>{this.canvasDomElement.style.setProperty("--cursor",0==t&&0==e?"auto":"grab")}))}setObservers(t,e,s){let n=null,i=0;a(t,this.drag$).subscribe((([{pattern:t,isNew:e},s={x:0,y:0}],o)=>{if(clearInterval(n),s.x||s.y)this.draw(t,s,.6);else if(e)i=0,n=setInterval((()=>{i+=.16,i>1?(this.draw(t,s,1),clearInterval(n)):this.draw(t,s,i)}),40);else if(0==t.length&&o){i=1;const t=o[0].pattern;n=setInterval((()=>{i-=.16,i<0?(this.draw(t,s,0),clearInterval(n)):this.draw(t,s,i)}),40)}else this.draw(t,s)})),e.subscribe((()=>{this.calculateDimensions()})),s.subscribe(((t,e)=>{this.setCellSize(t)}))}draw(t,e,s=1){const n=this.ctx,i=this.cellSize;n.fillStyle="#7e7e7e",n.lineWidth=1,n.fillRect(0,0,this.canvasDomElement.width+this.cellSize,this.canvasDomElement.height),n.strokeStyle="#999";for(let t=e.x%this.cellSize;t<=this.canvasDomElement.width;t+=this.cellSize)n.beginPath(),n.moveTo(t+.5,0),n.lineTo(t+.5,this.canvasDomElement.height),n.stroke();for(let t=e.y%this.cellSize;t<=this.canvasDomElement.height;t+=this.cellSize)n.beginPath(),n.moveTo(0,t+.5),n.lineTo(this.canvasDomElement.width,t+.5),n.stroke();if(n.fillStyle=`rgba(255, 255, 0, ${s})`,n.lineWidth=1,t.forEach((t=>{n.fillRect(t.x*i+1+e.x,t.y*i+1+e.y,i-1,i-1)})),this.ctxOffscreen){const t=this.offscreen.transferToImageBitmap();window.requestAnimationFrame((()=>{this.ctxOffscreen.transferFromImageBitmap(t)}))}}calculateDimensions(e=!0){const s=t("gol-canvas"),n=s.offsetWidth-20,i=s.offsetHeight-20,o=n%this.cellSize/2+9;if(this.canvasDomElement.style.setProperty("--width-mod",`${o}px`),this.canvasDomElement.width=n-n%this.cellSize,this.canvasDomElement.height=i-i%this.cellSize+1,this.ctxOffscreen&&(this.offscreen=new OffscreenCanvas(this.canvasDomElement.width,this.canvasDomElement.height),this.ctx=this.offscreen.getContext("2d",{alpha:!1})),e){const t={width:Math.floor(this.canvasDomElement.width/this.cellSize),height:Math.floor(this.canvasDomElement.height/this.cellSize)};this.dimension$.dispatch(t)}}setCellSize(t,e=!0){this.cellSize=t,this.calculateDimensions(e)}};g=h([b("gol-canvas"),l("design:paramtypes",[])],g);function f(t){const e=t.match(/(.+)#/);return e?e[1]:t}var m=new class{constructor(){this.subject$=new i,this.depth=0,this.dispatch(this.fullPath),window.onpopstate=()=>{this.dispatch(this.fullPath,!1)}}push(t,e=!0){this.depth++,history.pushState(null,"",t),this.dispatch(t,e)}back(){this.depth>0?(this.depth--,history.back()):this.push("/",!1)}get fullPath(){return`${document.location.pathname}${document.location.search}${document.location.hash}`}get observable$(){return this.subject$.observable()}dispatch(t,e=!0){setTimeout((()=>{this.subject$.dispatch({path:f(t),isNew:e})}),0)}};let w=class extends HTMLElement{constructor(){super(),this.subscribers=new Set,this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n      <style>\n        * {\n          box-sizing: border-box;\n        }\n\n        #whitebox {\n          position: absolute;\n          display: none;\n          left: 0;\n          top: 0;\n          width: 100vw;\n          height: 100vh;\n          justify-content: center;\n          align-items: center;\n          background-color: rgba(60, 60, 60, 0);\n          transition: background-color 250ms ease;\n          backdrop-filter: blur(3px);\n          z-index: 1000;\n        }\n\n        #whitebox.open {\n          display: flex;\n        }\n        \n        #whitebox.anim {\n          background-color: rgba(60, 60, 60, 0.8);\n        }\n        \n        section {\n          position: absolute;\n          transform: translate(0, 100px);\n          opacity: 0;\n          max-width: 60em;\n          width: 90vw;\n          max-height: 90vh;\n          background: white;\n          box-shadow: hsla(0, 0%, 0%, 0.3) 5px 5px 5px;\n          z-index: 2000;\n          transition: all 250ms ease;\n        }\n        \n        .anim section {\n          transform: translate(0, 0);\n          opacity: 1;\n        }\n        \n        .info-content {\n          top: 0;\n          max-height: 90vh;\n          overflow-y: scroll;\n          overflow-x: hidden;\n          overflow-scrolling: touch;\n          padding: 60px 2em 2em;\n          border: 2px solid transparent; /*bugfix*/\n        }\n        \n        @media (prefers-color-scheme: dark) {\n          .info-content {\n            background-color: #38393c;\n            color: #f4f3e6;\n          }\n        }\n        \n        .header {\n          display: flex;\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 70px;\n          background-color: rgba(255, 255, 255, 0.9);\n          backdrop-filter: blur(2px);\n          pointer-events: none;\n        }\n        \n        .close-button {\n          position: absolute;\n          top: 14px;\n          right: 2em;        \n        }\n        \n        gol-button {\n          --background: #2A4E97;\n          --color: white;\n        }\n        \n        @media (prefers-color-scheme: dark) {\n          gol-button {\n            --background: #29457D;\n          }\n          .header {\n            background-color: rgba(56, 57, 60, 0.9);\n          }\n        }\n\n        @media (max-width: 650px) {\n          section {\n            top: 0;\n            width: 100vw;\n            max-height: 100vh;\n          }\n          \n          .info-content {\n            padding: 60px 15px;\n            max-height: 100vh;\n          }\n          \n        .close-button {\n          right: 15px;        \n        }\n        }\n      </style>\n      \n      <div id="whitebox">\n        <section>\n          <div class="header"></div>\n          <gol-button class="close-button" icon="close" data-close></gol-button>\n          <div class="info-content">\n            <slot></slot>\n          </div>\n        </section>\n      </div>\n    '}setOpenAttribute(e){const s=null!=e;s?(t("#whitebox",this.shadowRoot).classList.add("open"),setTimeout((()=>{t("#whitebox",this.shadowRoot).classList.add("anim")}),0),t(".close-button",this.shadowRoot).focus()):(t("#whitebox",this.shadowRoot).classList.remove("anim"),setTimeout((()=>{t("#whitebox",this.shadowRoot).classList.remove("open")}),250)),this.infoIsOpen$.dispatch(s)}connectedCallback(){this.infoIsOpen$=new i;const e=o(t("[data-close]",this.shadowRoot),"click"),s=o(document.documentElement,"keyup").filter((t=>"Escape"==t.key&&this.hasAttribute("open"))),n=o(t("#whitebox",this.shadowRoot),"click").filter((t=>"whitebox"==t.target.id));this.subscribers.add(a(e,s,n).subscribe((()=>{m.push("/")}))),o(this,"click").subscribe((t=>{const e=t.target.closest("[data-url]");e&&m.push(e.getAttribute("data-url"))}))}disconnectedCallback(){this.subscribers.forEach((t=>{t.unsubscribe()}))}getObservers(){return{infoIsOpen$:this.infoIsOpen$.observable()}}};h([p("open"),l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],w.prototype,"setOpenAttribute",null),w=h([b("gol-info"),l("design:paramtypes",[])],w);const v=1048576;let x,y;let S=class extends HTMLElement{constructor(){super(),this.resetShape$=new i,this.clearShape$=new i,this.documentReady$=new i,this.timer=null,function(){u(this,void 0,void 0,(function*(){y=new WebAssembly.Memory({initial:64,maximum:64});const t={env:{memory:y}},e=fetch("/gol.wasm");if("instantiateStreaming"in WebAssembly)x=(yield WebAssembly.instantiateStreaming(e,t)).instance;else{const s=yield e,n=yield s.arrayBuffer(),i=yield WebAssembly.compile(n);x=yield WebAssembly.instantiate(i,t)}}))}(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n      <style>\n        :host {\n          width: 100vw;\n          position: relative;\n        }\n        \n        form {\n          display: flex;\n          justify-content:  center;\n          flex-wrap: wrap;\n          align-items:  center;\n          margin: 20px 5px;\n        }\n        \n        img {\n          vertical-align: bottom;\n          margin-left: 30px;\n        }\n        \n        input[type="range"] {\n          width: 80px;\n        }\n        \n        .generation {\n          position: relative;\n          left: 2px;\n          color: var(--fg-primary);\n          font-size: 20px;\n        }\n        \n        nowrap {\n          white-space: nowrap;\n        }\n        \n        nowrap > * {\n          vertical-align: middle;\n        }\n        \n        #shapes {\n          height: 40px;\n          padding: 0 5px 0 15px;\n          border: none;\n          border-radius: 8px;\n          background-color: #2A4E97;\n          color: white;\n          font-size: 20px;\n          box-shadow: 2px 2px 3px hsla(0, 0%, 0%, 0.3);\n        }\n        \n        #start {\n          --size: 60px;\n          --min-width: 220px;\n        }\n        \n        form gol-button {\n          --background: #2A4E97;\n          --color: white;\n          margin: 15px 20px 20px;\n        }\n\n        @media (prefers-color-scheme: dark) {\n          gol-button {\n            --background: #29457D;\n          }\n        }\n                \n        #controls {\n          display: flex;\n          flex-direction: column;\n          justify-content: space-around;\n          position: absolute;\n          top: -220px;\n          right: 40px;\n          height: 150px;\n          padding: 10px 40px;\n          border-radius: 10px;\n          box-shadow: 2px 2px 3px hsla(0, 0%, 0%, 0.2);\n          background-color: var(--bg-primary-transparent);\n          backdrop-filter: blur(3px);\n        }\n        \n        .control-item {\n          display: flex;\n          gap: 25px;\n          align-items: center;\n        }\n        \n        @media (max-width: 650px), (max-height: 650px) {\n          form {\n            margin: 0;\n            padding: 10px 0 20px;\n          }\n          form gol-button {\n            margin: 5px;\n          }\n\n          #start {\n            --min-width: 200px;\n          }\n\n          img {\n            margin-left: 10px;\n          }\n\n          #controls, #next, .generation {\n            display: none;\n          }\n        }\n\n        @media (pointer: coarse) {\n          #controls {\n            display: none;\n          }\n        }\n      </style>\n      \n      <form>\n        <gol-button icon="info" href="/info">Explanation</gol-button>\n        <gol-button icon="book" href="/lexicon" responsive="true">Lexicon</gol-button>\n        <gol-button id="start" icon="play">Start</gol-button>\n        <div>\n          <gol-button id="next" icon="redo">Next</gol-button>\n          <gol-button id="reset" icon="close">Clear</gol-button>\n        </div>\n        \n\n        <div id="controls">\n          <div class="control-item">\n            <svg width="20" height="20" viewBox="0 0 313 281" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;"><path d="M56.961,280.3c-34.939,-29.393 -56.961,-72.221 -56.961,-119.874c0,-88.541 76.03,-160.426 169.678,-160.426c60.073,0 112.897,29.581 143.052,74.164l-55.039,39.795c-23.62,-34.217 -63.104,-56.658 -107.788,-56.658c-72.236,0 -130.883,58.647 -130.883,130.883c0,35.908 14.492,68.459 37.941,92.116Z" style="fill:#000;"/><path d="M162.389,193.653c-1.065,1.886 -2.377,3.707 -3.935,5.407c-8.877,9.688 -22.364,11.798 -30.1,4.709c-7.737,-7.088 -6.81,-20.708 2.066,-30.396c1.64,-1.789 3.437,-3.32 5.326,-4.582l126.373,-110.976l-99.73,135.838Z" style="fill:#e61a1a;"/></svg>\n            <input id="speed" type="range" min="0" max="100" value="50" title="Speed dial" aria-label="Speed dial">\n          </div>\n\n          <div class="control-item">\n            <svg width="20" height="20" viewBox="0 0 225 225" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;"><path d="M181.444,0l-6.437,0l0,224.662l6.437,0l0,-224.662ZM49.655,0l-6.437,0l0,224.662l6.437,0l0,-224.662Z" style="fill:#000;"/><path d="M224.662,181.444l0,-6.437l-224.662,0l0,6.437l224.662,0ZM224.662,49.655l0,-6.437l-224.662,0l0,6.437l224.662,0Z" style="fill:#000;"/></svg>\n            <input id="size" type="range" min="0" max="100" value="43" title="Grid size" aria-label="Grid size">\n          </div>\n          \n          <div class="control-item">\n            <svg class="redo" xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="20"><path d="M0 0h24v24H0z" fill="none"/><path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"/></svg>\n            <span class="generation" title="Number of generations" aria-label="Number of generations">0</span>\n          </div>\n        </div>\n      </form>\n    '}connectedCallback(){this.isPlaying=!1,this.generation=0,this.setupSpeed(),this.setupSize(),this.setupStart(),this.setupGeneration(),this.setupReset()}getObservers(){const t=o(window,"orientationchange"),e=c(t,o(window,"resize"),this.documentReady$);return{nextShape$:this.nextShape$.observable(),resize$:e.observable(),size$:this.size$.observable(),reset$:this.resetShape$.observable(),clear$:this.clearShape$.observable(),rotate$:t.observable()}}setObservers(e,s,n,i){this.redraw$=e,this.documentReady$.dispatch(null),s.subscribe((()=>{this.setGeneration(0)})),n.subscribe((e=>{t("input, select, gol-button",this.shadowRoot).disabled=e})),e.subscribe((({pattern:e})=>{this.isPlaying||(t("#start, #next, #reset",this.shadowRoot).disabled=0==e.length)})),i.subscribe((()=>{this.setGeneration(0)}))}setGeneration(e){this.generation=e,t(".generation",this.shadowRoot).textContent=e.toString(10);const s=t("#reset",this.shadowRoot);0==e?(s.textContent="Clear",s.setAttribute("icon","close")):(s.textContent="Reset",s.setAttribute("icon","replay"))}setupSize(){const e=t("#size",this.shadowRoot);this.size$=c(o(e,"input").map((t=>Number(t.target.value))),(new i).dispatch(Number(e.value))).map((t=>Math.round(2+.38*t)))}play(){this.isPlaying=!0,clearTimeout(this.timer),this.nextGeneration$.dispatch()}stop(){this.isPlaying=!1,clearTimeout(this.timer)}setupStart(){o(t("#start",this.shadowRoot),"click").subscribe((t=>{this.isPlaying?(t.target.textContent="Start",t.target.setAttribute("icon","play"),this.stop()):(t.target.textContent="Stop",t.target.setAttribute("icon","stop"),this.play())}))}setupSpeed(){const e=t("#speed",this.shadowRoot);c(o(e,"input").map((t=>Number(t.target.value))),(new i).dispatch(Number(e.value))).subscribe((t=>{this.speed=1e3-100*Math.sqrt(t)}))}setupGeneration(){this.nextGeneration$=o(t("#next",this.shadowRoot),"click").filter((()=>!this.isPlaying)).map((()=>{})),this.nextShape$=this.nextGeneration$.map((()=>{this.setGeneration(this.generation+1);const t=function(t){const e=[],s=new Int32Array(y.buffer,v,2*t.length);t.forEach(((t,e)=>{s[2*e]=t.x,s[2*e+1]=t.y}));const n=x.exports._gol(v,1258272,t.length),i=new Int32Array(y.buffer,v,2*n);for(let t=0;t<n;t++)e.push({x:i[2*t],y:i[2*t+1]});return e}(this.redraw$.value().pattern);return this.isPlaying&&(this.timer=setTimeout((()=>{this.nextGeneration$.dispatch()}),this.speed)),t}))}setupReset(){o(t("#reset",this.shadowRoot),"click").subscribe((()=>{0==this.generation?(this.clearShape$.dispatch(),m.push("/")):(this.resetShape$.dispatch(),this.setGeneration(0))}))}};S=h([b("gol-controls"),l("design:paramtypes",[])],S);class ${constructor(){this.current=[],this.last=[],this.redraw$=new i}getObservers(){return{redraw$:this.redraw$.observable()}}setObservers(t,e,s,n,i,o,r,a,h,l){n.subscribe((()=>{this.redraw()})),c(t,e).subscribe((t=>{this.current=this.patternToShape(t),this.last=[...this.current];const e=n.value();e&&this.center(e),this.redraw(!0)})),o.subscribe((t=>{this.setOffset(t),this.redraw()})),s.subscribe((t=>{this.current=t,this.redraw()})),i.subscribe((t=>{this.toggle(t)})),r.subscribe((()=>{this.current=[...this.last],this.center(n.value()),this.redraw()})),l.subscribe((()=>{setTimeout((()=>{this.center(n.value()),this.redraw()}),100)})),a.subscribe((()=>{this.current=[],this.last=[],this.redraw()})),h.subscribe(((t,e)=>{if(null==e||t==e)return;const s=n.value();this.setOffset({x:Math.round((s.width-s.width*t/e)/2),y:Math.round((s.height-s.height*t/e)/2)}),this.redraw()}))}setOffset(t){this.current.forEach((e=>{e.x+=t.x,e.y+=t.y}))}redraw(t=!1){this.redraw$.dispatch({pattern:this.current,isNew:t})}center(t){let e=Number.MAX_VALUE,s=0,n=Number.MAX_VALUE,i=0;this.current.forEach((t=>{t.x>s&&(s=t.x),t.x<e&&(e=t.x),t.y>i&&(i=t.y),t.y<n&&(n=t.y)}));const o=Math.round(t.width/2-e-(s-e)/2),r=Math.round(t.height/2-n-(i-n)/2);this.current.forEach((t=>{t.x+=o,t.y+=r})),this.last=[...this.current]}toggle(t){const e=this.current.findIndex((e=>e.x==t.x&&e.y==t.y));-1==e?this.current.push(t):this.current.splice(e,1),this.last=[...this.current],this.redraw()}patternToShape(t){let e=[];const s=t.split(/\n/);""==s[0].trim()&&s.shift();for(let t=0;t<s.length;t++)for(let n=0;n<s[t].length;n++){"O"==s[t].trim()[n]&&e.push({x:n,y:t})}return e}}function z(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],window.addEventListener("error",(function(t){z("event","exception",{description:`${t.message} at ${t.filename}:${t.lineno}`,fatal:!1})}));let k=!1;function M(e){const s=t("#lexicon"),n=t("#info");function i(i,o,r){return u(this,void 0,void 0,(function*(){if(i){switch(i){case"/":E();break;case"/info":o?(n.setAttribute("open",""),E("Info")):(n.removeAttribute("open"),E());break;case"/lexicon":o?(s.setAttribute("open",""),E("Lexicon"),function(){u(this,void 0,void 0,(function*(){if(k)return;t("#lexicon .selection").innerHTML="Loading lexicon…",t("[data-term]").getAttribute("data-term");const e=yield(yield fetch("/list.html")).text();""!=e?(t("#lexicon .selection").innerHTML=e,k=!0):setTimeout((()=>{t("#lexicon .selection").innerHTML="Lexicon could not be loaded"}),1e3)}))}()):(s.removeAttribute("open"),E());break;default:if(o&&r){const t=i.match(/\/lexicon\/(.+)/);if(t){e.dispatch("");const s=yield(yield fetch(`/lexicon/data/${t[1]}.json`)).json();e.dispatch(s.pattern),E(s.name)}}}z("event","page_view",{page_location:i})}}))}m.observable$.subscribe((({path:t,isNew:e},s)=>{if(s){if(t==s.path)return;i(s.path,!1,s.isNew)}i(t,!0,e)}))}function E(t){var e;window.document.title=t?`${(e=t)[0].toUpperCase()}${e.substr(1)}`+" - John Conway’s Game of Life":"Play John Conway’s Game of Life"}var R;R="G-V6DPPMYG5N",z("js",new Date),z("config",R,{anonymize_ip:!0}),z("event","page_view");let D=class extends HTMLElement{constructor(){super(),this.subscribers=new Set,this.responsive=!1,this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n      <style>\n        #button {\n          min-width: var(--min-width, 0);\n          height: var(--size, 40px);\n          padding: 0 30px;\n          border-radius: calc( var(--size, 40px) * 0.5);\n          border: 2px solid transparent;\n          font-size: calc( var(--size, 40px) * 0.5);\n          text-transform: uppercase;\n          color: var(--color, white);\n          background-color: var(--background, royalblue);\n          box-shadow: 2px 2px 3px hsla(0, 0%, 0%, 0.3);\n          outline: none;\n          transition: all 250ms ease;\n        }\n        \n        #button.pressed {\n          box-shadow: inset 2px 2px 3px hsla(0, 0%, 0%, 0.3);\n        }\n        \n        #button.disabled {\n          background-color: #999;\n          color: #ccc;\n          box-shadow: none;\n        }\n        \n        #button.disabled svg {\n          fill: #ccc;\n        }\n        \n        .container {\n          position: relative;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n        \n        #button.pressed .container {\n          top: 1px;\n        }\n\n        #button:focus {\n          outline: none;\n          border: 2px solid white;\n        }\n        #button.no-focus:focus {\n          border: 2px solid transparent;\n        }\n        \n        /* Icons */\n        svg {\n          display: none;\n          width: calc(var(--size, 40px) * 0.7);\n          height: calc(var(--size, 40px) * 0.7);\n          fill: var(--color, white);\n        }\n        \n        .container.with-text:not(.responsive) svg {\n          margin-right: calc(var(--size, 40px) * 0.2);\n        }\n\n        .responsive slot {\n          display: none;\n        }\n          \n        svg.visible {\n          display: inline-block;\n        }\n      \n        @media (max-width: 650px), (max-height: 650px) {\n          #button {\n            padding: 0 20px;\n          }\n        }\n      </style>\n      \n      <button id="button">\n        <div class="container">\n          <svg class="close" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\n          <svg class="book" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><g><rect fill="none" height="24" width="24"/></g><g><g><g><path d="M17.5,4.5c-1.95,0-4.05,0.4-5.5,1.5c-1.45-1.1-3.55-1.5-5.5-1.5S2.45,4.9,1,6v14.65c0,0.65,0.73,0.45,0.75,0.45 C3.1,20.45,5.05,20,6.5,20c1.95,0,4.05,0.4,5.5,1.5c1.35-0.85,3.8-1.5,5.5-1.5c1.65,0,3.35,0.3,4.75,1.05 C22.66,21.26,23,20.86,23,20.6V6C21.51,4.88,19.37,4.5,17.5,4.5z M21,18.5c-1.1-0.35-2.3-0.5-3.5-0.5c-1.7,0-4.15,0.65-5.5,1.5V8 c1.35-0.85,3.8-1.5,5.5-1.5c1.2,0,2.4,0.15,3.5,0.5V18.5z"/></g></g></g></svg>\n          <svg class="info" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>\n          <svg class="play" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M8 5v14l11-7z"/></svg>\n          <svg class="redo" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"/></svg>\n          <svg class="replay" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/></svg>\n          <svg class="stop" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6 6h12v12H6z"/></svg>          \n          <slot></slot>\n        </div>\n      </button>\n    '}connectedCallback(){const e="1"==getComputedStyle(this).getPropertyValue("--small").trim();this.button=t("#button",this.shadowRoot),this.subscribers.add(o(this.button,"mousedown").subscribe(this.onPress)).add(o(this.button,"keydown").subscribe(this.onPress)).add(o(this.button,"mouseup").subscribe(this.onRelease)).add(o(this.button,"keyup").subscribe(this.onRelease)).add(o(this.button,"blur").subscribe(this.onRelease)).add(o(this.button,"click").subscribe((()=>{this.onClick()}))),this.textContent&&t(".container",this.shadowRoot).classList.add("with-text"),this.responsive&&e&&t(".container",this.shadowRoot).classList.add("responsive")}disconnectedCallback(){this.subscribers.forEach((t=>{t.unsubscribe()}))}setIcon(e){t("svg.visible",this.shadowRoot).classList.remove("visible"),t(`svg.${e}`,this.shadowRoot).classList.add("visible")}focus(t){this.button.focus(t)}blur(){this.button.blur()}set disabled(e){this.button.disabled=e,t("#button",this.shadowRoot).classList.toggle("disabled",e)}setResponsive(t){this.responsive=Boolean(t)}onClick(){this.hasAttribute("href")&&m.push(this.getAttribute("href"))}onPress(t){const e=t.target.closest("#button");"Tab"!=t.key?(e.classList.add("pressed"),e.classList.toggle("no-focus","keydown"!=t.type)):e.classList.remove("no-focus")}onRelease(t){t.target.closest("#button").classList.remove("pressed")}};h([p("icon"),l("design:type",Function),l("design:paramtypes",[String]),l("design:returntype",void 0)],D.prototype,"setIcon",null),h([p("disabled"),l("design:type",Object),l("design:paramtypes",[Object])],D.prototype,"disabled",null),h([p("responsive"),l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],D.prototype,"setResponsive",null),D=h([b("gol-button"),l("design:paramtypes",[])],D),document.addEventListener("DOMContentLoaded",(e=>{const s=t("gol-canvas"),n=t("gol-controls"),o=t("#info"),r=new $,a=new i,{infoIsOpen$:c}=o.getObservers(),{click$:h,dimension$:l,offset$:u,initialPattern$:d}=s.getObservers(),{redraw$:b}=r.getObservers(),{nextShape$:p,resize$:g,size$:f,reset$:m,clear$:w,rotate$:v}=n.getObservers();s.setObservers(b,g,f),r.setObservers(d,a,p,l,h,u,m,w,f,v),n.setObservers(b,h,c,a),M(a);try{navigator.serviceWorker.register("/service-worker.js")}catch(t){}}))}();
//# sourceMappingURL=bundle.min.js.map
